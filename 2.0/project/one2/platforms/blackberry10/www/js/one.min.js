var one={getHpAdMultiInfoAsync:function(b){var a=new Date().toTimeString();this.getJSONAsync(a,"hpmulti","http://211.152.49.184:7001/OneForWeb/one/getHpAdMultiinfo",function(c){try{$.getJSON(c,function(e){if(e.result==="SUCCESS"){b(e)}else{setTimeout(removeFile(a,"hpmulti"),0);b(null)}})}catch(d){console.error("[ONE]获取HPMULTI失败");console.error(d);setTimeout(removeFile(a,"hpmulti"),0);b(null)}})},getHomePageAsync:function(a,b){this.getJSONAsync(a,"home","http://211.152.49.184:7001/OneForWeb/one/getHpinfo?strDate="+a,function(c){try{$.getJSON(c,function(e){if(e.result==="SUCCESS"){b(e)}else{setTimeout(removeFile(a,"home"),1);b(null)}})}catch(d){console.error("[ONE]获取首页数据出错"+d);setTimeout(removeFile(a,"home"),0);b(null)}})},getOneContentInfoAsync:function(a,b){this.getJSONAsync(a,"content","http://211.152.49.184:7001/OneForWeb/one/getOneContentInfo?strDate="+a,function(c){try{$.getJSON(c,function(e){if(e.result==="SUCCESS"){b(e)}else{setTimeout(removeFile(a,"content"),0);b(null)}})}catch(d){console.error("[ONE]获取内容数据失败");console.error(d);setTimeout(removeFile(a,"content"),0);b(null)}})},getOneQuestionInfoAsync:function(a,b){this.getJSONAsync(a,"question","http://211.152.49.184:7001/OneForWeb/one/getOneQuestionInfo?strDate="+a,function(c){try{$.getJSON(c,function(e){if(e.result==="SUCCESS"){b(e)}else{console.error("[ONE]获取问题的API返回了FAIL，删除下载错误的文件。");setTimeout(removeFile(a,"question"),0);b(null)}})}catch(d){setTimeout(removeFile(a,"question"),0);console.error("[ONE]API超时或数据错误。"+d);b(null)}})},isCached:function(d,c){var b=this.buildfileurl(d,c);console.log("检查是否已缓存 : "+b);var a=new XMLHttpRequest();a.open("HEAD",b,false);a.send(null);console.log("状态码为 : "+a.status);if(a.status==0){return false}return true},buildfileurl:function(b,a){return"file://"+this.buildurl(b,a)},buildurl:function(b,a){return blackberry.io.home+"/"+b+a+".json"},getJSONAsync:function(c,b,a,d){if(this.isCached(c,b)){d(this.buildfileurl(c,b))}else{console.log("正在下载 : "+c+b);setTimeout(this.geturlAsync(a,this.buildurl(c,b),d),0)}},geturlAsync:function(a,c,d){try{blackberry.io.filetransfer.download(a,c,function(e){console.log("下载成功: "+e.fullPath);d("file://"+e.fullPath)},function(e){console.error("下载失败。");console.error("Error code: "+e.code);console.error("HTTP status: "+e.http_status);console.error("Source: "+e.source);console.error("Target: "+e.target);d(a)})}catch(b){console.log(b);d(a)}}};function removeFile(b,a){var c=blackberry.io.home+"/"+b+a+".json";if(global_fs){global_fs.root.getFile(c,{create:false},function(d){d.remove(function(){console.log("文件已删除。")},function(e){console.error(e)})},function(d){console.error(d)})}else{window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;window.requestFileSystem(window.PERSISTENT,5*1024*1024,function(d){global_fs=d;global_fs.root.getFile(c,{create:false},function(e){e.remove(function(){console.log("文件已删除。")},function(f){console.error(f)})},function(e){console.error(e)})},function(d){console.error(d)})}console.log("删除文件 >> "+c)}var global_fs=null;function removeByDate(a){var b=blackberry.io.home+"/"+a;console.log("删除文件 >> "+b);if(global_fs){global_fs.root.getFile(b+"home.json",{create:false},function(c){c.remove(function(){console.log(b+"home.json文件已删除。")},function(d){console.error(d)})},function(c){console.error(c)});global_fs.root.getFile(b+"content.json",{create:false},function(c){c.remove(function(){console.log(b+"content.json文件已删除。")},function(d){console.error(d)})},function(c){console.error(c)});global_fs.root.getFile(b+"question.json",{create:false},function(c){c.remove(function(){console.log(b+"question.json文件已删除。")},function(d){console.error(d)})},function(c){console.error(c)});global_fs.root.getFile(b+".jpg",{create:false},function(c){c.remove(function(){console.log(b+".jpg 文件已删除。")},function(d){console.error(d)})},function(c){console.error(c)})}else{window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;window.requestFileSystem(window.PERSISTENT,5*1024*1024,function(c){global_fs=c;global_fs.root.getFile(b+"home.json",{create:false},function(d){d.remove(function(){console.log(b+"home.json文件已删除。")},function(e){console.error(e)})},function(d){console.error(d)});global_fs.root.getFile(b+"content.json",{create:false},function(d){d.remove(function(){console.log(b+"content.json文件已删除。")},function(e){console.error(e)})},function(d){console.error(d)});global_fs.root.getFile(b+"question.json",{create:false},function(d){d.remove(function(){console.log(b+"question.json文件已删除。")},function(e){console.error(e)})},function(d){console.error(d)});global_fs.root.getFile(b+".jpg",{create:false},function(d){d.remove(function(){console.log(b+".jpg 文件已删除。")},function(e){console.error(e)})},function(d){console.error(d)})},function(c){console.error(c)})}};